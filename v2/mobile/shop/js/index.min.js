!function(t){function e(i){if(n[i])return n[i].exports;var o=n[i]={i:i,l:!1,exports:{}};return t[i].call(o.exports,o,o.exports,e),o.l=!0,o.exports}var n={};e.m=t,e.c=n,e.i=function(t){return t},e.d=function(t,n,i){e.o(t,n)||Object.defineProperty(t,n,{configurable:!1,enumerable:!0,get:i})},e.n=function(t){var n=t&&t.__esModule?function(){return t.default}:function(){return t};return e.d(n,"a",n),n},e.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},e.p="",e(e.s=4)}([function(t,e){},function(t,e){},function(t,e,n){n(5);var i=n(6)(n(3),n(7),null,null);t.exports=i.exports},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),window.scrollForbFn=function(t){t.preventDefault()},e.default={name:"bind-phone",data:function(){return{bindMyPhone:"",bindMyCode:"",bindTimer:null,bindMsg:"获取验证码",bindStartTimer:0}},props:["showbind","bindPhoneItem"],methods:{bindPhoneCheck:function(){if(!/\d{11}/.test(this.bindMyPhone))return void window.dialog.show("error","请输入正确的手机号",1);if(!/\d+/.test(this.bindMyCode))return void window.dialog.show("error","请输入正确的验证码",1);dialog.show("loading","手机绑定中...");var t=this,e=SDW_WEB.URLS.addParam({channel:SDW_WEB.channel,uid:SDW_WEB.USER_INFO.uid,token:SDW_WEB.MD5(""+SDW_WEB.channel+SDW_WEB.USER_INFO.uid+SDW_WEB.USER_INFO.secheme+t.bindTime+t.bindMyCode),sec:SDW_WEB.USER_INFO.secheme,time:t.bindTime},!1,HTTP_USER_STATIC+"checkcode");SDW_WEB.getAjaxData(e,function(e){if(1==e.result){var n=t.bindMyPhone.substring(0,3)+"****"+t.bindMyPhone.substring(7);e.myPhoneStr=n,dialog.show("ok","手机绑定成功",1),t.$emit("bind-callback",e)}else dialog.show("error",e.msg,1)})},getBindCode:function(){var t=this;if(!(this.bindStartTimer>0)){if(!/\d{11}/.test(this.bindMyPhone))return void window.dialog.show("error","请输入正确的手机号",1);var e=+new Date,n=+new Date,i=SDW_WEB.URLS.addParam({channel:SDW_WEB.channel,uid:SDW_WEB.USER_INFO.uid,token:SDW_WEB.MD5(""+SDW_WEB.channel+SDW_WEB.USER_INFO.uid+e+this.bindMyPhone+n+SDW_WEB.USER_INFO.otoken),phone:this.bindMyPhone,sec:e,time:n},!1,HTTP_USER_STATIC+"getcode");dialog.show("loading","验证码获取中..."),SDW_WEB.getAjaxData(i,function(e){1===e.result?(dialog.show("ok","验证码已发送",1),t.bindTime=e.time,t.bindStartTimer=60,t.bindTimer=setInterval(function(){t.bindStartTimer<=1?(clearInterval(t.bindTimer),t.bindStartTimer=0,t.bindMsg="获取验证码",t.bindTimer=null):t.bindMsg=t.bindStartTimer--+"秒后获取"},1e3)):dialog.show("error",e.msg,1)})}},transCoins:function(t){var e,n;return t<1e4?t:t<1e8?(e=t/1e4>>0,n=t%1e4+"",0==n?e+"万":e+"."+n[0]+"万"):t<1e10?(e=t/1e8>>0,n=t%1e8+"",0==n?e+"亿":e+"."+n[0]+"亿"):void 0}},computed:{show:function(){return this.showbind||0}},watch:{showbind:function(t,e){1==t?document.addEventListener("touchmove",scrollForbFn,!1):document.removeEventListener("touchmove",scrollForbFn,!1)}}}},function(t,e,n){function i(t){function e(){++i==n&&(p.egg.init=!0,dialog.hidden(),t&&t())}dialog.show("loading","初始化...");var n=20,i=0;["yellow","blue","green","red"].forEach(function(t){for(var n=1;n<6;n++){var i=new Image;i.src=u+"images/egg-"+t+"-"+n+".png",i.onload=e}})}function o(t){function e(){++o==i&&(p.lottery.init=!0,dialog.hidden(),t&&t())}dialog.show("loading","初始化...");var n=["blue-node","cl-bottom","cl-left","cl-right","lottery-border-1","lottery-border-2","red-node","lottery-btn-bottom","lottery-btn-click","lottery-btn-light","lottery-btn-normal","line-blue","line-red"],i=n.length+16,o=0;n.forEach(function(t){for(var n=1;n<16;n++){var i=new Image;i.src=u+"images/"+t+".png",i.onload=e}});for(var s=1;s<16;s++){var r=new Image;r.src=u+"images/light"+s+".png",r.onload=e}}function s(t){this.id=t.id||"undefined",this.scroll_width=.86*document.documentElement.clientWidth>>0,this.current_scroll_width=0,this.current_index=0,this.textArry=t.texts||[],this.isLoop=t.isLoop||!0,this.text_dom_width=0,this.delTime=t.delTime||1e3}function r(t,e){var n=e-t+1;return Math.random()*n+t>>0}function a(){var t="182****";return t+=r(100,999)}function l(t){for(var e=[],n=0;n<t;n++){var i=a(),o=f[r(0,f.length-1)];e.push("玩家 "+i+"，兑换了"+o)}return e}function d(t,e,n){for(e=e||5,t=t||[],n=n||t.length;e--;)t=t.sort(function(){return Math.random()-.5});return t.slice(0,n)}function c(){return d(l(30),3)}n(1),n(0);var u="https://www.shandw.com/mobile/shop/",h=n(2);!function(){for(var t=0,e=["ms","moz","webkit","o"],n=0;n<e.length&&!window.requestAnimationFrame;++n)window.requestAnimationFrame=window[e[n]+"RequestAnimationFrame"],window.cancelAnimationFrame=window[e[n]+"CancelAnimationFrame"]||window[e[n]+"CancelRequestAnimationFrame"];window.requestAnimationFrame||(window.requestAnimationFrame=function(e,n){var i=(new Date).getTime(),o=Math.max(0,16-(i-t)),s=window.setTimeout(function(){e(i+o)},o);return t=i+o,s}),window.cancelAnimationFrame||(window.cancelAnimationFrame=function(t){clearTimeout(t)})}();var m={tipWindow:!1,coinTipWindow:!1,phoneTipWindow:!1,bindInfo:{bindPhoneItem:{title:"话费充值"},num:"0",showbind:"1",show:!1,phone:""},taskInfo:{code:"",show:0,info:""},user:{avatar:SDW_WEB.USER_INFO.avatar,id:SDW_WEB.USER_INFO.id,nick:SDW_WEB.USER_INFO.nick,gold:0,stamp:0,luckyDrawCost:0,luckyEggCost:0},egg:{init:!1,timer:null,show:0,egg:[{type:"yellow",state:1,cz:0},{type:"red",state:1,cz:0},{type:"blue",state:1,cz:0},{type:"green",state:1,cz:0}],result:{show:0,money:0},cz:0,request:0,rule:0,pos:1},lottery:{init:!1,show:0,timer:null,stateIndex:0,items:null,startTime:+new Date,stamp:0,lottery:[],result:{show:0},btnState:"normal",aniObj:{time:0,stop:0,aniTime:100,canplay:1}},lists:[]},g={bindPhoneCallback:function(t){var e=this;dialog.hidden(),e.$nextTick(function(){e.$refs.taskgetalert.showInfo=1,e.user.phone=t.myPhoneStr})},showCountMsg:function(t){return-1==t.limit||-1==t.count||t.count-t.sell>0?"库存充足":"售罄"},gotoWeixinShandw:function(){location.href=SDW_WEB.SDW_WEIXIN_URL},gotoMyexcPage:function(){var t=SDW_PATH.MOBILE_ROOT+"myexc/?channel="+SDW_WEB.channel;SDW_WEB.openNewWindow({link:t,isFullScreen:!1,showMoreBtn:!1,title:"我的兑换记录"})},gotoAppMain:function(t){SDW_WEB.onShandw?SDW_WEB.sdw.switchTab(t):location.href=SDW_PATH.MOBILE_ROOT+t+"/?channel="+SDW_WEB.channel},showCode:function(){prompt("您的兑换码",this.lottery.result.code)},transCoins:function(t){if(t<1e4)return t;if(t<1e8){var e=t/1e4>>0,n=t%1e4+"";return e+"."+n[0]+"万"}if(t<1e10){var e=t/1e8>>0,n=t%1e8+"";return e+"."+n[0]+"亿"}},loadList:function(){var t=this,e=SDW_WEB.URLS.addParam({channel:SDW_WEB.channel,token:SDW_WEB.USER_INFO.token,uid:SDW_WEB.USER_INFO.uid,sec:SDW_WEB.USER_INFO.secheme},!1,HTTP_STATIC+"shop");SDW_WEB.getAjaxData(e,function(e){if(1==e.result){for(var n=0;n<e.list.length;n++){var i=e.list[n];3===i.pType?i.typeUrl="images/stamp-icon.png":1===i.pType&&(i.typeUrl="images/gold-icon.png")}var o=p.lists.concat(e.list);p.lists=o,p.bindInfo.phone=e.phone,p.user.gold=e.gold,p.user.stamp=e.stamp||0,p.user.luckyDrawCost=e.luckyDrawCost,p.user.luckyEggCost=e.luckyEggCost;var r=[];if(e.uilist.length){for(var a={},n=0;n<e.ulist.length;n++)a[e.ulist[n].id]||(a[e.ulist[n].id]=e.ulist[n].nick);for(var n=0;n<e.uilist.length;n++)r.push("玩家 "+(a[e.uilist[n].uid]||e.uilist[n].uid)+"，兑换了"+e.uilist[n].name)}else r=c();new s({id:"cbd",texts:r}).init(),t.lottery.lottery=e.luckyDrawItem}else dialog.show("error",e.msg,1)})},showCode:function(t){SDW_WEB.onShandw?(SDW_WEB.sdw.setClipboard(t),dialog.show("ok","兑换码已复制",1)):window.prompt("兑换码",t)},gotoPage:function(t){this.tipWindow=!1,this.openGame(t),this.$nextTick(function(){})},click:function(t,e){if("charge"==t)return this.charge(this.bindInfo.item),void(this.phoneTipWindow=!1);var n=this.checkPayState(t),i=this;if(1==n){if(8==t.iType)return void(this.bindInfo.phone?(this.bindInfo.num=t.rmb,this.bindInfo.item=t,this.bindInfo.show=!0):this.phoneTipWindow=!0);this.charge(t)}else 3==n?i.tipWindow=!0:dialog.show("error",n,1)},charge:function(t){var e=this,n=SDW_WEB.URLS.addParam({channel:SDW_WEB.channel,uid:SDW_WEB.USER_INFO.uid,token:SDW_WEB.USER_INFO.token,sec:SDW_WEB.USER_INFO.secheme,id:t.id,num:1},!1,HTTP_STATIC+"shopping");SDW_WEB.getAjaxData(n,function(n){1==n.result?(3==t.pType&&(p.user.stamp-=t.gold),1==t.pType&&(p.user.gold-=t.gold),t.buy++,t.sell++,n.code?(dialog.hidden(),e.taskInfo.show=1,e.taskInfo.code=n.code,e.taskInfo.info=t.info):(e.bindInfo.show=!1,dialog.show("ok",n.msg,1)),e.showCountMsg(t)):dialog.show("error",n.msg,1)})},checkPayState:function(t){if(-1!==t.limit&&t.count>=0&&t.count-t.sell<=0)return"该物品已经兑完";if(t.limit>=0&&t.limit<=t.buy)return"购买次数达到上限";switch(t.pType){case 1:return this.user.gold>=t.gold||"您的金币不足";case 2:case 3:return this.user.stamp>=t.gold||3}},closePage:function(t,e){"result"==t?(this.lottery.result.show=0,this.egg.result.show=0,this.closePage("games",e),clearInterval(this.egg.timer)):"games"==t&&(this.egg.show=0,this.lottery.show=0,this.egg.rule=0),this.egg.pos=1},initEgg:function(){var t=this;if(this.egg.init){this.egg.result.show=0,this.egg.cz=0,this.egg.request=0,this.egg.timer=null,this.egg.pos=1,this.egg.egg.forEach(function(t){t.state=1});document.querySelector("#egg-cz").className="egg-cz-0",setTimeout(function(){p.egg.pos=0},20),this.egg.show=1}else i(function(){t.initEgg()})},eggAnimation:function(t){t.state=2,p.egg.timer=setInterval(function(){5==t.state?t.state=4:t.state++},220)},openGame:function(t){"egg"==t&&this.initEgg(),"lottery"==t&&this.initLotteryFn()},scale:function(t,e){e.target.style.opacity=t},eggFn:function(t,e,n){if(!this.egg.request){if(this.user.gold<this.user.luckyEggCost)return void(this.coinTipWindow=1);var i=this;this.egg.cz=e;document.querySelector("#egg-cz").className="egg-cz-"+e,setTimeout(function(){p.eggAnimation(t)},450),this.egg.request=1,setTimeout(function(){var t=SDW_WEB.URLS.addParam({channel:SDW_WEB.channel,token:SDW_WEB.USER_INFO.token,uid:SDW_WEB.USER_INFO.uid,sec:SDW_WEB.USER_INFO.secheme},!1,HTTP_STATIC+"luckyegg");SDW_WEB.getAjaxData(t,function(t){1==t.result?(p.egg.result.money=t.stamps+"点券",p.egg.result.show=1,p.user.gold-=i.user.luckyEggCost,p.user.stamp+=t.stamps):dialog.show("error",t.msg,1)})},1200)}},initLotteryFn:function(){var t=this,e=this.lottery;if(e.init){e.btnState="normal",e.stateIndex=0;var n=Math.max(0,40),i=/^\+?[1-9][0-9]*$/.test(n/8+"")?n/8:n/8+1;e.aniObj.time=8*i,e.aniObj.stop=0,e.aniObj.aniTime=100,e.aniObj.canplay=1,!e.items&&(e.items=document.querySelectorAll(".lottery-items"));var s=document.querySelector(".lottery-items-select");s&&s.classList.remove("lottery-items-select"),setTimeout(function(){e.show=1},100)}else o(function(){t.initLotteryFn()})},lotteryBtnClick:function(t,e){var n=this;if("light"!==this.lottery.btnState&&(this.lottery.btnState=t,"light"===t)){if(this.user.gold<this.user.luckyDrawCost)return e.stopPropagation(),n.lottery.btnState="normal",n.coinTipWindow=1,void n.$nextTick(function(){});var i=SDW_WEB.URLS.addParam({channel:SDW_WEB.channel,token:SDW_WEB.USER_INFO.token,uid:SDW_WEB.USER_INFO.uid,sec:SDW_WEB.USER_INFO.secheme},!1,HTTP_STATIC+"luckydraw");SDW_WEB.getAjaxData(i,function(t){if(1===t.result){n.lottery.aniObj.stop=t.index-1;var e=n.lottery.lottery[t.index-1];n.lottery.result.icon=e.item,n.lottery.result.name=e.name,n.lottery.stamp=t.stamps||0,n.lottery.result.code=t.code}else dialog.show("error",t.msg,1)}),setTimeout(function(){p.lottery.startTime=+new Date,p.lottery.items[p.lottery.stateIndex].classList.add("lottery-items-select"),p.lottery.timer=requestAnimationFrame(p.lotteryLight)},1070)}},lotteryLight:function(){var t=this.lottery;if("normal"!=t.btnState){var e=+new Date;e-t.startTime>=t.aniObj.aniTime&&(t.startTime=e,t.items[t.stateIndex%8].classList.remove("lottery-items-select"),t.stateIndex++,t.items[t.stateIndex%8].classList.add("lottery-items-select"),t.aniObj.time<t.stateIndex&&(t.aniObj.aniTime=150+Math.min(150,2.1*(t.stateIndex-t.aniObj.time+1)*40),t.aniObj.stop<=t.stateIndex-40&&(t.aniObj.canplay=0,setTimeout(function(){p.user.gold-=p.user.luckyDrawCost,p.user.stamp+=t.stamp,t.result.show=1},3*t.aniObj.aniTime)))),t.aniObj.canplay&&(t.timer=requestAnimationFrame(this.lotteryLight))}}};s.prototype.init=function(){"undefined"!=this.id&&0!=this.textArry.length&&(document.querySelector("#"+this.id).innerHTML="<div class='scroll-texts-cont'><div class='text'></div></div>",this.text_dom=document.querySelector("#"+this.id+" .text"),this.start())},s.prototype.start=function(){if(this.current_index==this.textArry.length){if(!this.isLoop)return;this.current_index=0}this.text_dom.innerHTML=this.textArry[this.current_index]+"",this.text_dom.style.transform="translate3d("+this.scroll_width+"px,0,0)",this.text_dom.style.webkitTransform="translate3d("+this.scroll_width+"px,0,0)",this.text_dom.style.display="block",this.text_dom_width=this.text_dom.offsetWidth,this.current_scroll_width=this.scroll_width,requestAnimationFrame(this.timerFn.bind(this)),this.current_index++},s.prototype.timerFn=function(){this.current_scroll_width>-(this.text_dom_width+20)?(this.current_scroll_width--,this.text_dom.style.transform="translate3d("+this.current_scroll_width+"px,0,0)",this.text_dom.style.webkitTransform="translate3d("+this.current_scroll_width+"px,0,0)",requestAnimationFrame(this.timerFn.bind(this))):(this.text_dom.style.display="none",setTimeout(this.start.bind(this),this.delTime))};var f=["10MB流量","30MB流量","100MB流量"],p=new Vue({el:"#shop-root",data:m,methods:g,components:{bindPhone:h}});SDW_WEB.onShandw?SDW_WEB.getSdwUserData().then(function(t){p.user.avatar=SDW_WEB.USER_INFO.avatar||"http://www.shandw.com/pc/images/mandef.png",p.user.id=SDW_WEB.USER_INFO.id,p.user.nick=SDW_WEB.USER_INFO.nick,p.loadList()},function(){SDW_WEB.sdw.openLogin({success:function(){}})}):p.loadList()},function(t,e){},function(t,e){t.exports=function(t,e,n,i){var o,s=t=t||{},r=typeof t.default;"object"!==r&&"function"!==r||(o=t,s=t.default);var a="function"==typeof s?s.options:s;if(e&&(a.render=e.render,a.staticRenderFns=e.staticRenderFns),n&&(a._scopeId=n),i){var l=Object.create(a.computed||null);Object.keys(i).forEach(function(t){var e=i[t];l[t]=function(){return e}}),a.computed=l}return{esModule:o,exports:s,options:a}}},function(t,e){t.exports={render:function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("section",{directives:[{name:"show",rawName:"v-show",value:t.show,expression:"show"}],staticClass:"bind-phone-info-container"},[t.show?n("div",{staticClass:"mask",on:{click:function(e){if(e.stopPropagation(),e.target!==e.currentTarget)return null;t.showbind=0}}}):t._e(),t._v(" "),n("transition",{attrs:{name:"fade2"}},[n("div",{directives:[{name:"show",rawName:"v-show",value:t.show,expression:"show"}],staticClass:"bind-phone-infos"},[n("div",{staticClass:"bind-phone-name"},[t._v(t._s(t.bindPhoneItem.title))]),t._v(" "),n("div",{staticClass:"bind-phone-gift"},[t._v("奖励"),n("span",{staticClass:"conts-i"},[t._v(t._s(t.transCoins(t.bindPhoneItem.coin)))])]),t._v(" "),n("div",{staticClass:"desc"},[n("input",{directives:[{name:"model",rawName:"v-model",value:t.bindMyPhone,expression:"bindMyPhone"}],attrs:{type:"tel",placeholder:"请输入手机号码"},domProps:{value:t.bindMyPhone},on:{input:function(e){e.target.composing||(t.bindMyPhone=e.target.value)}}}),t._v(" "),n("input",{directives:[{name:"model",rawName:"v-model",value:t.bindMyCode,expression:"bindMyCode"}],attrs:{type:"tel",placeholder:"请输入验证码","data-module":"80%"},domProps:{value:t.bindMyCode},on:{input:function(e){e.target.composing||(t.bindMyCode=e.target.value)}}}),t._v(" "),n("div",{staticClass:"get-code",class:t.bindTimer?"":"normal-code",attrs:{id:"bindCode"},on:{click:function(e){if(e.stopPropagation(),e.target!==e.currentTarget)return null;t.getBindCode()}}},[t._v("\n                    "+t._s(t.bindMsg)+"\n                ")])]),t._v(" "),n("section",{staticClass:"login-btn-v3",on:{click:function(e){if(e.stopPropagation(),e.target!==e.currentTarget)return null;t.bindPhoneCheck()}}},[t._v("绑"),n("span",{staticStyle:{width:"20px"}}),t._v("定\n            ")])])])],1)},staticRenderFns:[]}}]);