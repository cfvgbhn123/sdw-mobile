!function(t){function e(a){if(o[a])return o[a].exports;var n=o[a]={i:a,l:!1,exports:{}};return t[a].call(n.exports,n,n.exports,e),n.l=!0,n.exports}var o={};e.m=t,e.c=o,e.i=function(t){return t},e.d=function(t,o,a){e.o(t,o)||Object.defineProperty(t,o,{configurable:!1,enumerable:!0,get:a})},e.n=function(t){var o=t&&t.__esModule?function(){return t.default}:function(){return t};return e.d(o,"a",o),o},e.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},e.p="",e(e.s=3)}([function(t,e){function o(t,e,o,a){if("function"!=typeof t)return void console.log("WindowScroll error: callback must be a Function!");this.toBottom=e||!1,this.enable=!0,this.callback=t||null,this.delayTime=o||200,this.offset=a||200,this.clientHeigth=document.documentElement.clientHeight||document.body.clientHeight,this._init()}o.prototype._init=function(){var t=this;t.timer=null,t.callback&&window.addEventListener("scroll",function(e){if(t.enable){var o=document.body.scrollTop+t.clientHeigth,a=document.documentElement.scrollHeight-t.offset,n=o>=a;(1==t.toBottom&&n||0==t.toBottom)&&!t.timer&&(t.timer=setTimeout(function(){t.callback(e),t.timer=null},t.delayTime))}},!1)},o.prototype.setCallback=function(t){"function"==typeof t?self.callback=t:console.log("[WindowScroll error]: callback must be a Function!")},o.prototype.runCallback=function(){this.callback&&this.callback()},t.exports=o},function(t,e){},function(t,e){},function(t,e,o){o(2),o(1);var a=o(0),n={userPayToken:"",currentPayItem:null,gameList:[],wxUserInfo:{},currentPage:"index",topText:"《怼怼三国》红包提现",payFrame:null,showPayFrame:!1,historyList:[],historyPage:0,preLoadImg:"images/ani.gif?nmm",loading:!1,recommendList:[{gameImg:"https://img.m3guo.com/group3/M00/00/C8/wKgMHFtpFPyAaK03AAYGKpuEALw205.gif",name:"决战沙城",gameid:"1247433539"},{gameImg:"https://img.m3guo.com/group2/M00/00/D2/wKgMHFvFVrOASCoIAAFaITcGDCY274.png",name:"大圣轮回",gameid:"2005641418"},{gameImg:"http://img.m3guo.com/group4/M00/00/18/wKgMHFtVqMuAd-WxAAZStFD138g796.png",name:"屠龙破晓",gameid:"2022222027"},{gameImg:"https://open.shandw.com/uploads/fb7671817f97cb13ef227c8cb7a09886.png",name:"凡人飞仙传",gameid:"2072357068"},{gameImg:"http://img.m3guo.com/group2/M00/00/D7/wKgMHFv9ED6AbOpbAAbJ6nabPXY187.gif",name:"古龙群侠传2",gameid:"1938532554"},{gameImg:"http://img.m3guo.com/group4/M00/00/28/wKgMHFvlAdGAXwoNAAdC2eslStQ018.gif",name:"三生三世",gameid:"1938270411"},{gameImg:"http://img.m3guo.com/group3/M00/00/CC/wKgMHFuFOxqAQxR0AAcsx7aI1ck080.png",name:"魔域来了",gameid:"2089003210"},{gameImg:"http://img.m3guo.com/group4/M00/00/2C/wKgMHFwcsLWAcmuZAAe-vx2iylA628.gif",name:"战龙酒馆",gameid:"1954719946"}]},i={openGame:function(t){if(!t)return void dialog.show("error","游戏不存在",1);location.href="http://www.shandw.com/mi/game/"+t+".html?channel=10000"},showRequestHistory:function(){this.historyList=[],this.historyPage=0,this.requestHistory()},getMoney:function(){if(this.wxUserInfo.redPkt&&this.wxUserInfo.redPkt<1)return void dialog.show("error","余额不足",1);if(!this.loading){this.loading=!0;var t=this;dialog.show("loading","数据请求中"),SDW_WEB.postAjaxData("http://platform.shandw.com/cpRedPktWithdraw",{uid:SDW_WEB.USER_INFO.uid,sdwcode:this.userPayToken,timestamp:(new Date).getTime(),amount:100*this.wxUserInfo.redPkt},function(e){t.loading=!1,1===e.result?dialog.show("ok","提现成功<br>红包到账可能存在一定程度延迟，敬请理解",3):dialog.show("error",e.msg,1)})}},requestGameItemList:function(){if(!this.userPayToken)return this.currentPage="index",void dialog.show("error","请输入闪电码",1);if(!this.loading){this.loading=!0;var t=this,e=SDW_WEB.URLS.addParam({payCode:t.userPayToken,channel:SDW_WEB.channel,sdwCode:"test"},!1,"http://platform.shandw.com/pageGameShopList");dialog.show("loading","数据请求中"),SDW_WEB.getAjaxData(e,function(e){1===e.result?(t.wxUserInfo=e,t.wxUserInfo.redPkt&&(t.wxUserInfo.redPkt=(t.wxUserInfo.redPkt/100).toFixed(2)),t.gameList=e.list||[],t.gameList.forEach(function(e){e.priceStr=t.transMoney(e.productPrice)}),t.topText="《"+e.appName+"》红包提现",t.currentPage="getMoney",dialog.hidden()):(t.currentPage="index",dialog.show("error",e.msg,1)),t.loading=!1})}},transMoney:function(t){return t*=.01,t=t.toFixed(2)},transTime:function(t){var e=new Date(t),o=e.getFullYear(),a=e.getMonth()+1,n=e.getDate();e.getHours(),e.getMinutes(),e.getSeconds();return o+"-"+a+"-"+n},startBuyItem:function(t){this.requestPayData(t)},sortKeys:function(t){var e=[],o=[];for(var a in t)e.push(a);e.sort();for(var a=0;a<e.length;a++)o.push(e[a]+"="+t[e[a]]);return o.join("&")},requestPayData:function(t){if(!this.loading){this.loading=!0,dialog.show("loading","数据请求中");var e={pay_uid:this.wxUserInfo.pay_uid,pay_channel:this.wxUserInfo.pay_channel,pay_appId:this.wxUserInfo.pay_appId,pay_areaId:this.wxUserInfo.pay_areaId||"",productId:t.productId||t.productName||"",productPrice:t.productPrice};e.sign=SDW_WEB.MD5(this.sortKeys(e)),e.channel=SDW_WEB.channel,SDW_WEB.onWeiXin&&(e.uid=SDW_WEB.USER_INFO.uid);var o=this,a=SDW_WEB.URLS.addParam(e,!1,"http://platform.shandw.com/pageGameShopOrder");SDW_WEB.getAjaxData(a,function(t){dialog.hidden(),1===t.result?t.data?o.startPay(t.data):(dialog.show("error","返回数据缺少data",1),console.log("返回数据[data]错误：请对照文档所给的示例")):-1===t.result?dialog.show("error",t.msg,1):dialog.show("error",JSON.stringify(t),1),o.loading=!1})}},startPay:function(t){t.wxopenid||delete t.wxopenid,t.payChannel="",this.postMessage(t)},showUserHistory:function(){this.currentPage="history"},postMessage:function(t){this.payFrame&&(SDW_WEB.onWeiXin||(this.showPayFrame=!0),this.payFrame.contentWindow.postMessage(JSON.stringify({postSdwData:!0,data:t,operate:"sdw_pay"}),"*"))},requestHistory:function(){if(!this.userPayToken)return void dialog.show("error","请输入闪电码",1);if(!this.loading){this.loading=!0,dialog.show("loading","数据请求中");var t=this,e=SDW_WEB.URLS.addParam({payCode:t.userPayToken,channel:SDW_WEB.channel,page:this.historyPage},!1,"http://platform.shandw.com/getUserPayRecord");SDW_WEB.getAjaxData(e,function(e){if(1===e.result){t.showUserHistory();var o=e.list||[];o.length&&(t.historyPage++,o.forEach(function(e){e.timeStr=t.transTime(e.time),e.priceStr=t.transMoney(e.money)}),t.historyList=t.historyList.concat(o)),dialog.hidden()}else t.historyList=[],dialog.show("error",e.msg,1);t.loading=!1})}},refreshPage:function(){location.reload()}};SDW_WEB.queryParam.id&&(n.preLoadImg="images/"+SDW_WEB.queryParam.id+".gif");var r=new Vue({el:"#app",data:n,methods:i,mounted:function(){var t=this;this.$nextTick(function(){t.payFrame=document.querySelector("#payFrame")}),document.querySelector("#app").style.display="block";new a(function(){"history"===t.currentPage&&r.requestHistory()},!0,100,30)}});SDW_WEB.getSdwUserData().then(function(t){console.log("获取成功")},function(t){console.log("获取闪电玩用户数据失败"),SDW_WEB.USER_INFO={}}),function(){window.addEventListener("message",function(e){if("string"==typeof e.data)try{var o=JSON.parse(e.data);if(o.postSdwData){var a=o.oprate||o.operate;t[a]&&t[a](o)}}catch(e){console.log(e)}},!1);var t={sdw_pay_close:function(){r.showPayFrame=!1}}}()}]);