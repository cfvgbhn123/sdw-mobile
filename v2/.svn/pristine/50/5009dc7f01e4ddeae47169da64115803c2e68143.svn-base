!function(t){function e(i){if(n[i])return n[i].exports;var o=n[i]={i:i,l:!1,exports:{}};return t[i].call(o.exports,o,o.exports,e),o.l=!0,o.exports}var n={};return e.m=t,e.c=n,e.i=function(t){return t},e.d=function(t,n,i){e.o(t,n)||Object.defineProperty(t,n,{configurable:!1,enumerable:!0,get:i})},e.n=function(t){var n=t&&t.__esModule?function(){return t.default}:function(){return t};return e.d(n,"a",n),n},e.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},e.p="",e(e.s=8)}([function(t,e,n){var i=(n(5),n(4)),o=n(6),s={};n(7),window.NOW_TIME=+new Date,function(t){function e(){for(var t=[],e=0;e<S.length;e++){var n=S[e];t.push({index:n,tap:0,title:y[n],icons:[T+n+"-icon.png",T+n+"-icon-select.png"]})}return t[0].tap=1,t}function n(){for(var t={},e=0;e<S.length;e++){var n=S[e];t[n]=0==e}return t}function a(){return APP.onQQ||APP.onWeiXin||APP.onWeiBo?[]:["weixin","weibo","qq","dh"]}function r(){var t=APP.onShandw?Shandw_USER.avatar:USER_DATA.avatar;return t=t||"https://www.shandw.com/pc/images/mandef.png",D.myAvatar=t,t}function h(){var t=APP.onShandw?Shandw_USER.nick||Shandw_USER.uid:USER_DATA.nick||USER_DATA.id;return D.myNick=t,t}function u(){var t=APP.onShandw?Shandw_USER.uid:USER_DATA.id,e="true"==localStorage["_my_barrageFlag"+t];return D.barrageFlag=e,e}function c(t){var e=new Date(t),n=NOW_TIME-t,i=(e.getFullYear(),e.getMonth()+1),o=e.getDate();return n<864e5?n<36e5?n<6e4?(n/1e3>>0)+"秒前":(n/6e4>>0)+"分前":(n/36e5>>0)+"时前":(i<10&&(i="0"+i),o<10&&(o="0"+o),i+"-"+o)}function d(){return APP.onIOS?T+"ios.jpg":APP.onQQBrowser?T+"qq.jpg":APP.onBaiduBrowser?T+"baidu.jpg":APP.onUCBrowser?T+"uc.jpg":APP.onLiebao?T+"liebao.jpg":(APP.onShandw,"")}function l(){return APP.onIOS?"*若您在微信、QQ、微博等APP内，需先通过右上角分享功能，将页面用safari浏览器打开。":APP.onQQBrowser?"":APP.onBaiduBrowser?"":APP.onUCBrowser?"":APP.onLiebao?"":"请根据当前的浏览器，添加到桌面"}function g(t){var e=new IScroll(t,{probeType:3,scrollbars:!1,mouseWheel:!1,hScrollbar:!1,interactiveScrollbars:!1,fadeScrollbars:!1});w.push(e)}function f(){var t=_myFuchuang.userInputsMsg;t&&(p.sendMessage(2010,{uid:USER_DATA.id,msg:t,buffer:!0}),_myFuchuang.userInputsMsg="",_myFuchuang.userInputWindow=0)}var m,p=null,w=[],T="https://www.shandw.com/v2/mobile/game/images/",y={desktop:"保存游戏",gift:"我的礼包",game:"更多游戏",chat:"世界畅聊"},S=["gift","desktop","game"],_=Math.min(19,APP.width/320*16)/32*.853,A=APP.height,v=270*_,E=240*_,P=100*_,U={},D={tipWindow:0,showDownload:APP.onShandw?0:1,showCollect:APP.onWeiXin||APP.onQQ||!1,onWeixin:APP.onWeiXin,loginIcons:a(),loginMask:APP.onIOS?"ios-mask":"and-mask",loginFlagV2:0,APP_ROOT_PAGE:"https://www.shandw.com/mobile/?channel="+window.channel,visitorNavs:{index:1},isVisitor:visitorMode.isVisitor,chatFlag:!0,showUnloadPage:!1,pageWidth:APP.width,pagesHeight:A-v,visitorPagesHeight:A-E,chatHeight:P,myAvatar:"",myNick:"",browserTips:l(),myGold:0,showEwm:0,fchidden:1,myGifts:0,appType:d(),gid:getUrlObj().gid,navs:e(),navsTap:n(),giftLists:[],userInputWindow:0,tuijianLists:[],zuijinLists:[],unloadLists:[],userInputsMsg:"",barrageFlag:"",chatsLists:[],phoneLoginData:{getCodeFlag:!1,phoneNum:"",phoneCode:"",RES_TIME:"",timerHand:null},timerHand:null,codeMessage:"获取验证码"};r(),h(),u();var b={gotoSdwHome:function(){location.href=this.APP_ROOT_PAGE},refreshPhoneData:function(){this.tipWindow=0,this.phoneLoginData.getCodeFlag=!1,this.phoneLoginData.phoneNum="",this.phoneLoginData.phoneCode="",this.phoneLoginData.RES_TIME="",this.phoneLoginData.timerHand=null,this.codeMessage="获取验证码",clearInterval(this.timerHand),this.timerHand=null;var t=document.querySelector("#getCode")||document.querySelector("#getCode-v2");t.className="codenormal"},timers:function(){var t=this,e=60,n=document.querySelector("#getCode")||document.querySelector("#getCode-v2");n.className="codetimer",t.codeMessage=e--+"秒后获取",t.timerHand=setInterval(function(){e<=0?(clearInterval(t.timerHand),n.className="codenormal",t.codeMessage="获取验证码",t.phoneLoginData.getCodeFlag=!1):t.codeMessage=e--+"秒后获取"},1e3)},refreshUser:function(){APP.onShandw?sdw.openLogin({success:function(){sdw.getUserInfo({success:function(t){Shandw_USER=t,authGame()},fail:function(t){alert(t.msg)}})},cancel:function(){sdw.closeWindow()}}):this.loginFlagV2=1},downloadFn:function(){location.href="https://www.shandw.com/app/download/"},getPhoneCode:function(){var t=this,e=this.phoneLoginData;if(!e.getCodeFlag)if(/^1\d{10}$/.test(e.phoneNum)){e.getCodeFlag=!0;var n=t.isVisitor?"&vst=1&vsttoken="+visitorMode.visitorToken:"",i=+new Date/1e3>>0,o=(new Date).Format("yyyyMMdd"),s=faultylabs.MD5("SDW"+o+channel+APP.guid+e.phoneNum+i),a=HTTP_USER_STATIC+"telcode?channel="+channel+"&phone="+e.phoneNum+"&time="+i+"&sign="+s+n;dialog.show("loading","验证码获取中..."),getData(a,function(n){e.RES_TIME=n.time,e.getCodeFlag=!0,t.timers(),1==n.phone?(dialog.hidden(),t.tipWindow=1):dialog.show("ok","验证码已发送",1)},function(t){e.getCodeFlag=!1,dialog.show("error",t.msg,1)})}else dialog.show("error","请输入正确的手机号",1)},phoneLogin:function(t){var e=this,n=this.phoneLoginData;if(/^1\d{10}$/.test(n.phoneNum))if(/^\d+$/.test(n.phoneCode)){var i=t?"&vst=1&vsttoken="+visitorMode.visitorToken:"",o=HTTP_USER_STATIC+"telcheck?channel="+channel+"&phone="+n.phoneNum+"&time="+n.RES_TIME+"&sign="+faultylabs.MD5(channel+APP.guid+n.phoneNum+n.RES_TIME+n.phoneCode)+i;dialog.show("loading","数据更新中..."),getData(o,function(t){e.refreshPhoneData(),localStorage[DATAITEM]=JSON.stringify(t),console.log(DATAITEM,JSON.stringify(t)),USER_DATA=t,e.myNick=USER_DATA.nick||USER_DATA.id,e.myAvatar=USER_DATA.avatar||"http://www.shandw.com/pc/images/mandef.png",s.setVisitorMode(!1);var n=+new Date,i=HTTP_USER_STATIC+"authgame?gid="+C_url.gid+"&uid="+USER_DATA.id+"&token="+faultylabs.MD5(channel+USER_DATA.id+n+USER_DATA.token)+"&sec="+n+"&channel="+channel;getData(i,function(t){setShareInfo(t),configWX(t),checkGameUrl(t),dialog.show("ok","您已登录成功",1),e.loginFlagV2=0},function(t){dialog.show("error",t.msg,1)})},function(t){dialog.show("error",t.msg,1)})}else dialog.show("error","请输入正确的验证码",1);else dialog.show("error","请输入正确的手机号",1)},showDialog:function(t){dialog.show("error",t,1)},showUnloadPageFn:function(){this.showUnloadPage=!1,window.history.pushState({oprate:"show"},"","#")},cancelInput:function(){document.querySelector("#user-input").blur();var t=this;setTimeout(function(){t.userInputWindow=0},320)},showUserInput:function(){this.userInputWindow=1,document.querySelector("#my-menu").click()},sendUserChatMsg:function(){document.querySelector("#user-input").blur(),f()},changeBarrage:function(){this.barrageFlag=!this.barrageFlag;var t=APP.onShandw?Shandw_USER.uid:USER_DATA.id;localStorage["_my_barrageFlag"+t]=this.barrageFlag+""},tabNav:function(t,e){for(var n=0;n<this.navs.length;n++)this.navs[n].tap=n==e?1:0,this.navsTap[this.navs[n].index]=this.navs[n].index==t.index;this.showEwm=0,this.$nextTick(function(){setTimeout(function(){for(var t=0;t<w.length;t++)w[t].refresh()},100)})},tabNav2:function(t){this.visitorNavs.index=t,this.showEwm=0,setTimeout(function(){for(var t=0;t<w.length;t++)w[t].refresh()},100)},showEwmFn:function(t){this.showEwm=t},giftBtnFn:function(t){if(""==t.code&&0==t.request){if(t.request=1,APP.onShandw)var e=HTTP_STATIC+"getgift?channel="+channel+"&token="+Shandw_USER.token+"&sec="+Shandw_USER.secheme+"&uid="+Shandw_USER.uid+"&gid="+this.gid;else var n=+new Date,e=HTTP_STATIC+"getgift?channel="+channel+"&token="+faultylabs.MD5(channel+USER_DATA.id+n+USER_DATA.token)+"&sec="+n+"&uid="+USER_DATA.id+"&gid="+this.gid;dialog.show("loading","礼包领取中"),getData(e+"&id="+t.id,function(e){t.code=e.code,_myFuchuang.myGifts--,dialog.show("ok","礼包领取成功",1)},function(t){})}},fchiddenFn:function(e){return this.fchidden=e,e?void t("#my-game-container").removeClass("my-game-container-ani"):void setTimeout(function(){for(var t=0;t<w.length;t++)w[t].refresh()},300)},getGameInfo:function(){var t=HTTP_STATIC+"gameinfo?gid="+this.gid;getData(t,function(t){for(var e=[],n=0;n<t.gift.length;n++)e.push({title:t.gift[n].name,des:t.gift[n].info,num:_myFuchuang.transNum(t.gift[n].num,t.gift[n].count),code:"",id:t.gift[n].id,request:0});_myFuchuang.myGifts=t.gift.length,_myFuchuang.giftLists=e},function(t){console.log(t.msg)})},getUserGames:function(){function e(t,e,n){for(var i=t.slice(0),o=n-t.length,s=0;o>0;o--,s++)i.push(e[s]);return i}var n=+new Date,i=this;if(APP.onShandw)var o=HTTP_STATIC+"usergame?token="+Shandw_USER.token+"&sec="+Shandw_USER.secheme+"&uid="+Shandw_USER.uid+"&type=1&page=0";else var o=HTTP_STATIC+"usergame?token="+faultylabs.MD5(channel+USER_DATA.id+n+USER_DATA.token)+"&sec="+n+"&uid="+USER_DATA.id+"&type=1&page=0";o+="&imei="+APP.guid+"&os="+APP.os+"&tg=0&w="+APP.width+"&h="+APP.height,t.ajax({type:"GET",url:o,dataType:"jsonp",jsonp:"cb",timeout:18e5,jsonpCallback:"callFn"+ +new Date+(65536*(1+Math.random())|0).toString(16).substring(1),success:function(t,n){for(var o=t.list||[],s=t.recommend||[],a=e(o,s,4),r=[],h=0;h<a.length;h++){var u=a[h];r.push({title:u.name,icon:u.icon,id:u.id,time:c(u.time)})}i.unloadLists=r},error:function(t,e){}})},transNum:function(t,e){return t/e*100>>0},getGamesInfo:function(t){var e=GUID();if(APP.onShandw)var n=HTTP_STATIC+"pcgg?token="+Shandw_USER.token+" &sec="+Shandw_USER.secheme+" &uid="+Shandw_USER.uid+"&flag="+t.flag+"&type="+t.type+"&page="+t.page;else var n=HTTP_STATIC+"pcgg?token="+faultylabs.MD5(channel+USER_DATA.id+e+USER_DATA.token)+" &sec="+e+" &uid="+USER_DATA.id+"&flag="+t.flag+"&type="+t.type+"&page="+t.page;getData(n,function(t){for(var e=[],n=0;n<t.list.length;n++)U[t.list[n].id]||e.push({title:t.list[n].name,des:t.list[n].sub,icon:t.list[n].icon,id:t.list[n].id,gift:t.list[n].gift});_myFuchuang.tuijianLists=e},function(t){console.log(t.msg)})},getUserInfo:function(){if(APP.onShandw)var t=HTTP_STATIC+"userinfo?channel="+channel+"&uid="+Shandw_USER.uid+"&sec="+Shandw_USER.secheme+"&token="+Shandw_USER.token+"&type=1";else var e=+new Date,t=HTTP_STATIC+"userinfo?channel="+channel+"&uid="+USER_DATA.id+"&sec="+e+"&token="+faultylabs.MD5(channel+USER_DATA.id+e+USER_DATA.token)+"&type=1";getData(t,function(t){NOW_TIME=+new Date;var e=[],n=Math.min(4,_myFuchuang.zuijinLists.length);t.recent=t.recent||[];for(var i=0;i<t.recent.length;i++)e.push({title:t.recent[i].name,icon:t.recent[i].icon,id:t.recent[i].id,time:c(t.recent[i].time)}),i<=n&&(U[t.recent[i].id]=1);_myFuchuang.zuijinLists=e,_myFuchuang.myGold=0,_myFuchuang.getGamesInfo({type:"",page:0,flag:1})},function(t){console.log(t.msg)})},goToGames:function(t){location.href="https://www.shandw.com/v2/mobile/game/?gid="+t.id+"&channel="+channel}};window._myFuchuang=_myFuchuang;var I={1146308431:1};s={init:function(e){if(D.isVisitor=e,_myFuchuang=new Vue({el:"#app",data:D,methods:b}),_myFuchuang.$nextTick(function(){e?g("#my-zm-s2"):s.initUserView()}),_myFuchuang.getUserGames(),D.chatFlag&&(m=new i({el:"#barrage-cont"}),m.addText({msg:"快来闪电玩"}),m.addText({msg:"指尖的乐趣，就来闪电玩"})),!I[C_url.gid]){var n=new o({id:"#my-menu",position:"1,0.1"});t(n.target).css("visibility","visible")}},setVisitorMode:function(t){_myFuchuang.isVisitor=t,w=[],setTimeout(function(){t?g("#my-zm-s2"):s.initUserView()},100)},initUserView:function(){setTimeout(_myFuchuang.getUserInfo,250),g("#my-lb-s"),g("#my-zm-s"),g("#my-gm-s"),D.chatFlag&&g("#my-zm-kf"),_myFuchuang.getGameInfo()}},document.addEventListener("touchmove",function(t){t.preventDefault()},!1),t("#menu-btn").tap(function(e){_myFuchuang.fchiddenFn(0),APP.onIOS&&t("#my-game-container").addClass("my-game-container-ani")}),document.querySelector("#my-menu").addEventListener("click",function(e){e.preventDefault(),p?(t("#outer-chat-cont").css("display","block"),document.querySelector("#user-input").focus(),_myFuchuang.showUserInput()):dialog.show("error","聊天功能还没开启",1)},!1),window.history.replaceState({game:"root"},"","#"),window.history.pushState({oprate:"show"},"","#"),window.addEventListener("popstate",function(t){var e=window.history.state;"root"==e.game?_myFuchuang.showUnloadPage=1:(e.oprate="show")&&window.history.back()},!1),document.ontouchend=function(){window.history.pushState({oprate:"show"},"","#"),document.ontouchend=null}}(Zepto),t.exports=s},function(t,e){},function(t,e){},function(t,e,n){var i={INSTRUCT:{2010:"SimpleMessage",2011:"SimpleMessageACK"},INSTRUCT_ID_LEN:4,RECEIVER_ID_LEN:4,MESSAGE_ID_LEN:4};i.createSendFrame=function(t,e,n,i){if(4!=arguments.length)return null;var o=0;i.constructor==Uint8Array&&(o=i.byteLength);var s=this.INSTRUCT_ID_LEN+this.MESSAGE_ID_LEN+this.RECEIVER_ID_LEN+o,a=this.toUint8Array(new Uint16Array([s]),!0),r=this.toUint8Array(new Uint32Array([t]),!0),h=this.toUint8Array(new Uint32Array([e]),!0),u=this.toUint8Array(new Uint32Array([n]),!0);return this.concatBuffer(a,r,h,u,i)},i.parseSendFrame=function(t){if(t.constructor!=ArrayBuffer)return null;var e=new Uint8Array(t),n={};n.origin=e,n.byteLength=this.subBufferToU_16(e,0,2),n.instructions=this.subBufferToU_32(e,2,6),n.messageID=this.subBufferToU_32(e,6,10),n.receiverID=this.subBufferToU_32(e,10,14);var i=t.slice(14);return n.data=new Uint8Array(i),n},i.subBufferToU_32=function(t,e,n){var i=t.subarray(e,n).reverse(),o=new Uint8Array(i);return new Uint32Array(o.buffer)[0]},i.subBufferToU_16=function(t,e,n){var i=t.subarray(e,n).reverse(),o=new Uint8Array(i);return new Uint16Array(o.buffer)[0]},i.concatBuffer=function(t){var e,n=0,i=0;for(e=0;e<arguments.length;e++)i+=arguments[e].byteLength;var o=new Uint8Array(i);for(e=0;e<arguments.length;e++)for(var s=0;s<arguments[e].byteLength;s++)o[n++]=arguments[e][s];return o},i.toUint8Array=function(t,e){if(t.constructor==Uint8Array)return e?t.reverse():t;if(t.constructor==Uint16Array||Uint32Array){var n=new Uint8Array(t.buffer);return e&&(n=n.reverse()),n}return null},i.showData=function(t,e){if(t)if(e){var n=t.subarray(0,2).toString(),i=t.subarray(2,6).toString(),o=t.subarray(6,10).toString(),s=t.subarray(10,14).toString(),a=t.subarray(14,t.byteLength).toString(),r=[n,i,o,s,a];console.log("data["+t.byteLength+"] ",r.join(" | "))}else console.log("data["+t.byteLength+"] ",t.toString())},t.exports=i},function(t,e){function n(t){this._init(t)}function i(t){this._init(t)}!function(){for(var t=0,e=["ms","moz","webkit","o"],n=0;n<e.length&&!window.requestAnimationFrame;++n)window.requestAnimationFrame=window[e[n]+"RequestAnimationFrame"],window.cancelAnimationFrame=window[e[n]+"CancelAnimationFrame"]||window[e[n]+"CancelRequestAnimationFrame"];window.requestAnimationFrame||(window.requestAnimationFrame=function(e,n){var i=+new Date,o=Math.max(0,16-(i-t)),s=window.setTimeout(function(){e(i+o)},o);return t=i+o,s}),window.cancelAnimationFrame||(window.cancelAnimationFrame=function(t){clearTimeout(t)})}(),n.prototype._init=function(t){this.MAX_NUM=t.max||2,this.ROOT=document.querySelector(t.el),this.ROOT_WIDTH=document.documentElement.clientWidth,this.ROOT_HEIGHT=this.ROOT.offsetHeight,this.CLIENT_WIDTH=document.documentElement.clientWidth,this.CLIENT_HEIGHT=document.documentElement.clientHeight,this.CLIENT_DPR=window.devicePixelRatio||1,this.TEXT_ID=1,this.texts=[],this.queueText=[],this.textPool=[],this.TEXT_HEIGHT=20,this.sliceText=[],this.stage=this.createCanvas(this.ROOT_WIDTH*this.CLIENT_DPR,72*this.CLIENT_DPR),this.stageContext=this.stage.getContext("2d"),this.stage.style.width=this.ROOT_WIDTH+"px",this.stage.style.height="72px",this.stage.style.position="absolute",this.stage.style.backgroundImage="-webkit-linear-gradient(right, rgba(0,0, 0, 0) 0%, rgba(0,0, 0, 0.6) 100%)",this.stage.style.backgroundImage="linear-gradient(right, rgba(0,0, 0, 0) 0%, rgba(0,0, 0, 0.6) 100%)",this.stageContext.font=16*this.CLIENT_DPR+"px arial",this.stageContext.fillStyle="#fff",this.stageContext.textBaseline="top",this.stageContext.shadowColor="#000",this.stageContext.shadowOffsetX=0,this.stageContext.shadowOffsetY=1,this.stageContext.shadowBlur=1,this.ROOT.appendChild(this.stage),this.createPool(),this.animate(),this.defalutText=["点我可以弹字幕哦","闪电玩平台，指尖的精彩","闪电玩快来玩"]},n.prototype.createCanvas=function(t,e){var n=document.createElement("canvas");return n.width=t||this.CLIENT_WIDTH,n.height=e||this.CLIENT_HEIGHT,n},n.prototype.createPool=function(){for(var t=0;t<this.MAX_NUM;t++){var e=new i;e.textId=this.TEXT_ID++,e.y=18*(e.textId-1)*this.CLIENT_DPR,this.textPool.push(e)}},n.prototype.addText=function(t){var e,n;this.texts.length>=this.MAX_NUM?this.queueText.push(t):(e=this.textPool.shift(),e.text=t.msg,e.x=this.stage.width+this.selectFrom(0,10),n=Math.random(),e.speed=(this.selectFrom(2,3)+(n>.4?.4:n))*this.CLIENT_DPR/2,e.width=this.stageContext.measureText(t.msg).width,this.texts.push(e))},n.prototype.removeText=function(t){for(var e=0;e<this.texts.length;e++)if(this.texts[e].textId==t.textId)return this.texts.splice(e,1),this.textPool.push(t),void(t.text="")},n.prototype.selectFrom=function(t,e){var n=e-t+1;return Math.random()*n+t>>0},n.prototype.updateTexts=function(){for(var t=0;t<this.sliceText.length;t++);},n.prototype.animate=function(){this.timer=window.requestAnimationFrame(this.loop.bind(this))},n.prototype.loop=function(){this.stageContext.clearRect(0,0,this.stage.width,this.stage.height);for(var t=0,e=this.texts.length;t<e;){var n=this.texts[t];if(n&&n.text)if(n.x>>0<=-n.width){this.removeText(n);var i=this.queueText.length?this.queueText.shift():{msg:this.defalutText[this.selectFrom(0,this.defalutText.length-1)]};this.addText(i)}else n.x=n.x-n.speed,this.stageContext.fillText(n.text,n.x,n.y),t++}this.timer=window.requestAnimationFrame(this.loop.bind(this))},i.prototype._init=function(t){this.x=0,this.y=0,this.speed=0,this.text=t||"",this.width=0},i.prototype.updateCache=function(){this.stageContext.clearRect(0,0,this.canvas.width,this.canvas.height),this.stageContext.fillText(this.text,0,0),this.cacheText=this.stageContext.getImageData(0,0,1024,40)},t.exports=n},function(t,e,n){function i(t){this.MESSAGEID=1,this._init(t)}var o=n(3);i.prototype._init=function(t){var e=this;this.checkSuppBuffer()?(this.INSTRUCT_MODULE={},this.ProtoBuf=dcodeIO.ProtoBuf,this.PROTO_FILE=this.ProtoBuf.loadProtoFile("ld_client_messenger.proto"),this.INSTRUCT_MODULE[2010]=this.PROTO_FILE.build("SimpleMessage"),this.INSTRUCT_MODULE[2011]=this.PROTO_FILE.build("SimpleMessageACK"),this.MUTIL_INSTRUCT=this.PROTO_FILE.build("SimpleMessageMutil"),this.ws=new WebSocket(t.url),this.ws.onopen=function(){e.ws.binaryType="arraybuffer",t.openFn&&t.openFn(),e.ws.onmessage=function(n){var i=o.parseSendFrame(n.data),s=e.INSTRUCT_MODULE[i.instructions].decode(i.data);t.messageFn&&t.messageFn(i.instructions,s)}},this.ws.onerror=t.errorFn||function(){},this.ws.onclose=t.closeFn||function(){}):console.log("[ChatRoom]: not Support!")},i.prototype.sendMessage=function(t,e){var n=this["build_"+t+"_Unit"](e.uid,e.msg,e.buffer),i=o.createSendFrame(t,this.MESSAGEID++,123,new Uint8Array(n));this.ws.send(i.buffer)},i.prototype.build_2010_Unit=function(t,e,n){var i=new this.INSTRUCT_MODULE[2010],o=+new Date/1e3>>0;return i.setSender(parseInt(t)),i.setContent(e),i.setTime(o),n?i.toArrayBuffer():i},i.prototype.checkSuppBuffer=function(){for(var t=!0,e=["Uint8Array","Uint16Array","Uint32Array","WebSocket"],n=0;n<e.length;n++)window[e[n]]||(t=!1);var i="undefined"!=typeof dcodeIO&&dcodeIO.ProtoBuf;return t&&i},t.exports=i},function(t,e){function n(t){return this.id=t.id||"",this.adsorbed=t.adsorbed||!0,this.duration=t.duration||.3,this.position=t.position||"1,0.5",this.adsorb=t.adsorb||!1,this.init(),this}n.prototype.init=function(){if(this.id){this.target=document.querySelector(this.id),this.WIDTH=document.documentElement.clientWidth||document.body.clientWidth,this.HEIGHT=document.documentElement.clientHeight||document.body.clientHeight,this.offX=0,this.offY=0,this.width=this.target.offsetWidth,this.height=this.target.offsetHeight,this.tapFlag=!1,this.timer=null,this.hasMove=!1;var t=this.position.split(","),e=parseFloat(t[0])*(this.WIDTH-this.width)>>0,n=parseFloat(t[1])*(this.HEIGHT-this.height)>>0;this.target.style.transform="translate3d("+e+"px,"+n+"px,0)",this.target.style.webkitTransform="translate3d("+e+"px,"+n+"px,0)",this.target.style.opacity="0.5",this.target.addEventListener("touchstart",this.touchDown.bind(this),!1),document.addEventListener("touchmove",this.touchMove.bind(this),!1),this.target.addEventListener("touchend",this.touchUp.bind(this),!1)}},n.prototype.touchDown=function(t){if(t.preventDefault(),!this.tapFlag){this.hasMove=!1,this.target.style.transition="none",this.target.style.webkitTransition="none",this.target.style.opacity="1";var e=this.target.getBoundingClientRect();if(t.touches)var n=t.touches[0];else var n=t;this.offX=n.clientX-e.left,this.offY=n.clientY-e.top,this.tapFlag=!0,clearTimeout(this.timer)}},n.prototype.touchMove=function(t){if(this.tapFlag){if(t.preventDefault(),this.hasMove=!0,t.changedTouches)var e=t.changedTouches[0];else var e=t;var n=e.clientY-this.offY,i=e.clientX-this.offX;n=Math.max(0,n),n=Math.min(this.HEIGHT-this.height,n),i=Math.max(0,i),i=Math.min(this.WIDTH-this.width,i),this.target.style.transform="translate3d("+i+"px,"+n+"px,0)",this.target.style.webkitTransform="translate3d("+i+"px,"+n+"px,0)"}},n.prototype.touchUp=function(t){if(t.preventDefault(),this.tapFlag){if(this.tapFlag=!1,t.changedTouches)var e=t.changedTouches[0];else var e=t;var n=e.clientX-this.offX,i=e.clientY-this.offY;if(i=Math.max(0,i),i=Math.min(this.HEIGHT-this.height,i),n=n<=this.WIDTH/2-this.width/2&&this.adsorb?0:this.WIDTH-this.width,this.top=i,this.left=n,this.target.style.webkitTransition="cubic-bezier(0.5,1.95,.49,.73)  "+this.duration+"s",this.target.style.transition="cubic-bezier(0.5,1.95,.49,.73)  "+this.duration+"s",this.target.style.webkitTransform="translate3d("+n+"px,"+i+"px,0)",this.target.style.transform="translate3d("+n+"px,"+i+"px,0)",this.timer=setTimeout(function(){this.target.style.opacity="0.5"}.bind(this),2e3),!this.hasMove){var o="canvas"==t.target.tagName.toLocaleLowerCase();("barrage-cont"==t.target.className||"barrage-text"==t.target.className||o)&&this.target.click()}}},t.exports=n},function(t,e){},function(t,e,n){n(2),n(1),window.toolWindow=n(0),Date.prototype.Format=function(t){var e={"M+":this.getMonth()+1,"d+":this.getDate(),"h+":this.getHours(),"m+":this.getMinutes(),"s+":this.getSeconds(),"q+":Math.floor((this.getMonth()+3)/3),S:this.getMilliseconds()};/(y+)/.test(t)&&(t=t.replace(RegExp.$1,(this.getFullYear()+"").substr(4-RegExp.$1.length)));for(var n in e)new RegExp("("+n+")").test(t)&&(t=t.replace(RegExp.$1,1==RegExp.$1.length?e[n]:("00"+e[n]).substr((""+e[n]).length)));return t},function(t){window.activityAPI={sec:+new Date,id:channel,taskMap:{},debug:1,HTTP_URL:"https://shop-app.m3guo.com/",log:function(t){this.debug&&console.log(t)},getTaskList:function(t,e,n){return t=t||{},"undefined"==typeof t.appid?void this.log("缺少appid"):(t.id=this.id,APP.onShandw?(t.sec=Shandw_USER.secheme,t.token=Shandw_USER.token):(t.sec=this.sec,t.token=faultylabs.MD5(this.id+USER_DATA.id+this.sec+USER_DATA.token)),void this.getData(this.HTTP_URL+"?op=game_task",function(t){e&&e(t)},function(t){n&&n(t)},t))},finishedTask:function(t,e,n){t.id=this.id,APP.onShandw?(t.sec=Shandw_USER.secheme,t.token=Shandw_USER.token):(t.sec=this.sec,t.token=faultylabs.MD5(this.id+USER_DATA.id+this.sec+USER_DATA.token)),this.getData(this.HTTP_URL+"?op=game_task_finish",function(t){e&&e(t)},function(t){n&&n(t)},t)},getReward:function(t,e,n){t.id=this.id,APP.onShandw?(t.sec=Shandw_USER.secheme,t.token=Shandw_USER.token):(t.sec=this.sec,t.token=faultylabs.MD5(this.id+USER_DATA.id+this.sec+USER_DATA.token)),this.getData(this.HTTP_URL+"?op=game_task_award",function(t){e&&e(t)},function(t){n&&n(t)},t)},getData:function(e,n,i,o){o=o||{},o.imei||(o.imei=APP.guid),o.os||(o.os=APP.os),o.w||(o.w=APP.width),o.h||(o.h=APP.height);var s=+new Date;t.ajax({type:"GET",url:e,data:o,dataType:"jsonp",jsonp:"cb",timeout:18e4,jsonpCallback:"callFn"+ +new Date,success:function(t){t.callStartTimes=s,1==t.result?n(t,1):t.result==-3?alert(t.msg):i(t)},error:function(t,e){i({msg:"xhr请求失败"})}})}};HTTP_USER_STATIC+"authgame";APP.onShandw?sdw.getUserInfo({success:function(t){Shandw_USER=t,authGame(),toolWindow.init(visitorMode.isVisitor)},fail:function(t){alert(t.msg)}}):visitorMode.isVisitor?(visitorMode.authGame(),toolWindow.init(visitorMode.isVisitor)):(authGame(),toolWindow.init(visitorMode.isVisitor))}(Zepto)}]);