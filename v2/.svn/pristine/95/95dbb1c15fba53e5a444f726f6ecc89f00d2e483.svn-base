!function(t){function e(n){if(i[n])return i[n].exports;var o=i[n]={i:n,l:!1,exports:{}};return t[n].call(o.exports,o,o.exports,e),o.l=!0,o.exports}var i={};return e.m=t,e.c=i,e.i=function(t){return t},e.d=function(t,i,n){e.o(t,i)||Object.defineProperty(t,i,{configurable:!1,enumerable:!0,get:n})},e.n=function(t){var i=t&&t.__esModule?function(){return t.default}:function(){return t};return e.d(i,"a",i),i},e.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},e.p="",e(e.s=6)}([function(t,e,i){var n=i(3),o=i(4),s={};i(5),window.NOW_TIME=+new Date,function(t){function e(){for(var t=[],e=0;e<_.length;e++){var i=_[e];t.push({index:i,tap:0,title:E[i],icons:[S+i+"-icon.png",S+i+"-icon-select.png"]})}return t[0].tap=1,t}function i(){for(var t={},e=0;e<_.length;e++){var i=_[e];t[i]=0==e}return t}function a(){return SDW_WEB.onQQ||SDW_WEB.onWeiXin||SDW_WEB.onWeiBo?[]:["weixin","weibo","qq","dh"]}function r(){SDW_WEB.USER_INFO=SDW_WEB.USER_INFO||{};var t=SDW_WEB.USER_INFO.avatar;return t=t||"https://www.shandw.com/pc/images/mandef.png",y.myAvatar=t,t}function h(){SDW_WEB.USER_INFO=SDW_WEB.USER_INFO||{};var t=SDW_WEB.USER_INFO.nick||SDW_WEB.USER_INFO.uid;return y.myNick=t,t}function c(){SDW_WEB.USER_INFO=SDW_WEB.USER_INFO||{};var t=SDW_WEB.USER_INFO.uid,e="true"==localStorage["_my_barrageFlag"+t];return y.barrageFlag="",e}function d(t){var e=new Date(t),i=NOW_TIME-t,n=(e.getFullYear(),e.getMonth()+1),o=e.getDate();return i<864e5?i<36e5?i<6e4?(i/1e3>>0)+"秒前":(i/6e4>>0)+"分前":(i/36e5>>0)+"时前":(n<10&&(n="0"+n),o<10&&(o="0"+o),n+"-"+o)}function u(){return SDW_WEB.onIOS?S+"ios.jpg":SDW_WEB.onQQBrowser?S+"qq.jpg":SDW_WEB.onBaiduBrowser?S+"baidu.jpg":SDW_WEB.onUCBrowser?S+"uc.jpg":SDW_WEB.onLiebao?S+"liebao.jpg":(SDW_WEB.onShandw,"")}function l(){return SDW_WEB.onIOS?"*若您在微信、QQ、微博等APP内，需先通过右上角分享功能，将页面用safari浏览器打开。":SDW_WEB.onQQBrowser?"":SDW_WEB.onBaiduBrowser?"":SDW_WEB.onUCBrowser?"":SDW_WEB.onLiebao?"":"请根据当前的浏览器，添加到桌面"}function g(t){var e=new IScroll(t,{probeType:3,scrollbars:!1,mouseWheel:!1,hScrollbar:!1,interactiveScrollbars:!1,fadeScrollbars:!1});w.push(e)}function m(){var t=W.userInputsMsg;t&&(p.sendMessage(2010,{uid:USER_DATA.id,msg:t,buffer:!0}),W.userInputsMsg="",W.userInputWindow=0)}var f,W,p=null,w=[],S="https://www.shandw.com/v2/mobile/game/images/",E={desktop:"保存游戏",gift:"我的礼包",game:"更多游戏",chat:"世界畅聊"},_=["gift","desktop","game"],D=Math.min(19,SDW_WEB.width/320*16)/32*.853,v=SDW_WEB.height,T=270*D,x=240*D,B=100*D,I={},y={tipWindow:0,showDownload:SDW_WEB.onShandw?0:1,showCollect:SDW_WEB.onWeiXin||SDW_WEB.onQQ||!1,onWeixin:SDW_WEB.onWeiXin,loginIcons:a(),loginMask:SDW_WEB.onIOS?"ios-mask":"and-mask",loginFlagV2:0,APP_ROOT_PAGE:"https://www.shandw.com/v2/mobile/index/?channel="+SDW_WEB.channel,visitorNavs:{index:1},isVisitor:visitorMode.isVisitor,chatFlag:!0,showUnloadPage:!1,pageWidth:SDW_WEB.width,pagesHeight:v-T,visitorPagesHeight:v-x,chatHeight:B,myAvatar:"",myNick:"",browserTips:l(),myGold:0,showEwm:0,fchidden:1,myGifts:0,appType:u(),gid:SDW_WEB.queryParam.gid,navs:e(),navsTap:i(),giftLists:[],userInputWindow:0,tuijianLists:[],zuijinLists:[],unloadLists:[],userInputsMsg:"",barrageFlag:"",chatsLists:[],phoneLoginData:{getCodeFlag:!1,phoneNum:"",phoneCode:"",RES_TIME:"",timerHand:null},timerHand:null,codeMessage:"获取验证码"},F={gotoSdwHome:function(){location.href=this.APP_ROOT_PAGE},refreshPhoneData:function(){this.tipWindow=0,this.phoneLoginData.getCodeFlag=!1,this.phoneLoginData.phoneNum="",this.phoneLoginData.phoneCode="",this.phoneLoginData.RES_TIME="",this.phoneLoginData.timerHand=null,this.codeMessage="获取验证码",clearInterval(this.timerHand),this.timerHand=null;var t=document.querySelector("#getCode")||document.querySelector("#getCode-v2");t.className="codenormal"},timers:function(){var t=this,e=60,i=document.querySelector("#getCode")||document.querySelector("#getCode-v2");i.className="codetimer",t.codeMessage=e--+"秒后获取",t.timerHand=setInterval(function(){e<=0?(clearInterval(t.timerHand),i.className="codenormal",t.codeMessage="获取验证码",t.phoneLoginData.getCodeFlag=!1):t.codeMessage=e--+"秒后获取"},1e3)},refreshUser:function(){SDW_WEB.onShandw?SDW_WEB.sdw.openLogin({success:function(){SDW_WEB.sdw.getUserInfo({success:function(t){SDW_WEB.USER_INFO=t,authGame()},fail:function(t){alert(t.msg)}})},cancel:function(){SDW_WEB.sdw.closeWindow()}}):this.loginFlagV2=1},downloadFn:function(){location.href="https://www.shandw.com/app/download/"},getPhoneCode:function(){var t=this,e=this.phoneLoginData;if(!e.getCodeFlag)if(/^1\d{10}$/.test(e.phoneNum)){e.getCodeFlag=!0;var i=t.isVisitor?"&vst=1&vsttoken="+visitorMode.visitorToken:"",n=SDW_WEB.channel,o=+new Date/1e3>>0,s=(new Date).Format("yyyyMMdd"),a=SDW_WEB.URLS.addParam({channel:n,phone:e.phoneNum,time:o,sign:SDW_WEB.MD5("SDW"+s+n+SDW_WEB.guid+e.phoneNum+o)},!1,HTTP_USER_STATIC+"telcode");dialog.show("loading","验证码获取中..."),SDW_WEB.getAjaxData(a+i,function(i){1==i.result?(e.RES_TIME=i.time,e.getCodeFlag=!0,t.timers(),1==i.phone?(dialog.hidden(),t.tipWindow=1):dialog.show("ok","验证码已发送",1)):(e.getCodeFlag=!1,dialog.show("error",i.msg,1))})}else dialog.show("error","请输入正确的手机号",1)},phoneLogin:function(t){var e=this,i=this.phoneLoginData;if(/^1\d{10}$/.test(i.phoneNum))if(/^\d+$/.test(i.phoneCode)){var n=t?"&vst=1&vsttoken="+visitorMode.visitorToken:"",o=SDW_WEB.URLS.addParam({channel:SDW_WEB.channel,phone:i.phoneNum,time:i.RES_TIME,sign:SDW_WEB.MD5(SDW_WEB.channel+SDW_WEB.guid+i.phoneNum+i.RES_TIME+i.phoneCode)},!1,HTTP_STATIC+"telcheck");dialog.show("loading","数据更新中..."),SDW_WEB.getAjaxData(o+n,function(t){if(1==t.result){e.refreshPhoneData();var i={uid:t.id,otoken:t.token,nick:t.nick,sex:t.sex,avatar:t.avatar,city:t.city,fl:t.fl};SDW_WEB.Store.set(SDW_WEB.localItem,i,!0),localStorage.setItem(window.DATAITEM,JSON.stringify(i)),dialog.show("ok","登录成功",1),i.secheme=+new Date,i.token=SDW_WEB.MD5(""+SDW_WEB.channel+i.uid+i.secheme+i.otoken),SDW_WEB.USER_INFO=i,e.myNick=i.nick||i.id,e.myAvatar=i.avatar||"http://www.shandw.com/pc/images/mandef.png",s.setVisitorMode(!1),authGame(function(t){dialog.show("ok","您已登录成功",1),e.loginFlagV2=0})}else dialog.show("error",t.msg,1)})}else dialog.show("error","请输入正确的验证码",1);else dialog.show("error","请输入正确的手机号",1)},showDialog:function(t){dialog.show("error",t,1)},showUnloadPageFn:function(){this.showUnloadPage=!1,window.history.pushState({oprate:"show"},"","#")},cancelInput:function(){document.querySelector("#user-input").blur();var t=this;setTimeout(function(){t.userInputWindow=0},320)},showUserInput:function(){this.userInputWindow=1,document.querySelector("#my-menu").click()},sendUserChatMsg:function(){document.querySelector("#user-input").blur(),m()},changeBarrage:function(){this.barrageFlag=!this.barrageFlag;var t=SDW_WEB.USER_INFO.uid;SDW_WEB.Store.set("_my_barrageFlag"+t,this.barrageFlag,!0)},tabNav:function(t,e){for(var i=0;i<this.navs.length;i++)this.navs[i].tap=i==e?1:0,this.navsTap[this.navs[i].index]=this.navs[i].index==t.index;this.showEwm=0,this.$nextTick(function(){setTimeout(function(){for(var t=0;t<w.length;t++)w[t].refresh()},100)})},tabNav2:function(t){this.visitorNavs.index=t,this.showEwm=0,setTimeout(function(){for(var t=0;t<w.length;t++)w[t].refresh()},100)},showEwmFn:function(t){this.showEwm=t},giftBtnFn:function(t){if(""==t.code){if(0==t.request){t.request=1;var e=SDW_WEB.URLS.addParam({channel:SDW_WEB.channel,token:SDW_WEB.USER_INFO.token,sec:SDW_WEB.USER_INFO.secheme,uid:SDW_WEB.USER_INFO.uid,gid:this.gid,id:t.id},!1,HTTP_STATIC+"getgift");dialog.show("loading","礼包领取中"),SDW_WEB.getAjaxData(e,function(e){1==e.result&&(t.code=e.code,W.myGifts--,dialog.show("ok","礼包领取成功",1))})}}else prompt("礼包码",t.code)},fchiddenFn:function(e){return this.fchidden=e,e?void t("#my-game-container").removeClass("my-game-container-ani"):void setTimeout(function(){for(var t=0;t<w.length;t++)w[t].refresh()},300)},getGameInfo:function(){var t=SDW_WEB.URLS.addParam({gid:this.gid},!1,HTTP_STATIC+"gameinfo");SDW_WEB.getAjaxData(t,function(t){if(1==t.result){for(var e=[],i=0;i<t.gift.length;i++)e.push({title:t.gift[i].name,des:t.gift[i].info,num:W.transNum(t.gift[i].num,t.gift[i].count),code:"",id:t.gift[i].id,request:0});W.myGifts=t.gift.length,W.giftLists=e}})},getUserGames:function(){function t(t,e,i){for(var n=t.slice(0),o=i-t.length,s=0;o>0;o--,s++)n.push(e[s]);return n}var e=(+new Date,this),i=SDW_WEB.URLS.addParam({channel:SDW_WEB.channel,token:SDW_WEB.USER_INFO.token,sec:SDW_WEB.USER_INFO.secheme,uid:SDW_WEB.USER_INFO.uid,type:1,page:0},!1,HTTP_STATIC+"usergame");SDW_WEB.getAjaxData(i,function(i){if(1==i.result){for(var n=i.list||[],o=i.recommend||[],s=t(n,o,4),a=[],r=0;r<s.length;r++){var h=s[r];a.push({title:h.name,icon:h.icon,id:h.id,time:d(h.time)})}e.unloadLists=a}})},transNum:function(t,e){return t/e*100>>0},getGamesInfo:function(t){var e=SDW_WEB.URLS.addParam({token:SDW_WEB.USER_INFO.token,sec:SDW_WEB.USER_INFO.secheme,uid:SDW_WEB.USER_INFO.uid,flag:t.flag,type:t.type,page:t.page},!1,HTTP_STATIC+"pcgg");SDW_WEB.getAjaxData(e,function(t){if(1==t.result){for(var e=[],i=0;i<t.list.length;i++)I[t.list[i].id]||e.push({title:t.list[i].name,des:t.list[i].sub,icon:t.list[i].icon,id:t.list[i].id,gift:t.list[i].gift});W.tuijianLists=e}})},getUserInfo:function(){var t=SDW_WEB.URLS.addParam({channel:SDW_WEB.channel,uid:SDW_WEB.USER_INFO.uid,sec:SDW_WEB.USER_INFO.secheme,token:SDW_WEB.USER_INFO.token,type:1},!1,HTTP_STATIC+"userinfo");SDW_WEB.getAjaxData(t,function(t){if(1==t.result){NOW_TIME=+new Date;var e=[],i=Math.min(4,W.zuijinLists.length);t.recent=t.recent||[];for(var n=0;n<t.recent.length;n++)e.push({title:t.recent[n].name,icon:t.recent[n].icon,id:t.recent[n].id,time:d(t.recent[n].time)}),n<=i&&(I[t.recent[n].id]=1);W.zuijinLists=e,W.myGold=0,W.getGamesInfo({type:"",page:0,flag:1})}})},goToGames:function(t){location.href=SDW_WEB.MOBILE_ROOT+"game/?gid="+t.id+"&channel="+SDW_WEB.channel}},b={1146308431:1};s={init:function(e){if(r(),h(),c(),y.isVisitor=e,W=new Vue({el:"#app",data:y,methods:F}),W.$nextTick(function(){e?g("#my-zm-s2"):s.initUserView()}),W.getUserGames(),y.chatFlag&&(f=new n({el:"#barrage-cont"}),f.addText({msg:"快来闪电玩"}),f.addText({msg:"指尖的乐趣，就来闪电玩"})),!b[SDW_WEB.queryParam.gid]){var i=new o({id:"#my-menu",position:"1,0.1"});t(i.target).css("visibility","visible"),window._myFuchuang=W}},setVisitorMode:function(t){W.isVisitor=t,visitorMode.isVisitor=t,w=[],setTimeout(function(){t?g("#my-zm-s2"):s.initUserView()},100)},initUserView:function(){g("#my-lb-s"),g("#my-zm-s"),g("#my-gm-s"),y.chatFlag&&g("#my-zm-kf"),W.getGameInfo()}},document.addEventListener("touchmove",function(t){t.preventDefault()},!1),t("#menu-btn").tap(function(e){W.fchiddenFn(0),SDW_WEB.onIOS&&t("#my-game-container").addClass("my-game-container-ani")}),document.querySelector("#my-menu").addEventListener("click",function(e){e.preventDefault(),p&&(t("#outer-chat-cont").css("display","block"),document.querySelector("#user-input").focus(),W.showUserInput())},!1),SDW_WEB.onShandw||SDW_WEB.onKD||SDW_WEB.onWeiXin||SDW_WEB.onQQ||(window.history.replaceState({game:"root"},"","#"),window.history.pushState({oprate:"show"},"","#"),window.addEventListener("popstate",function(t){var e=window.history.state;"root"==e.game?W.showUnloadPage=1:(e.oprate="show")&&window.history.back()},!1),document.ontouchend=function(){window.history.pushState({oprate:"show"},"","#"),document.ontouchend=null})}(Zepto),t.exports=s},function(t,e){},function(t,e){},function(t,e){function i(t){this._init(t)}function n(t){this._init(t)}!function(){for(var t=0,e=["ms","moz","webkit","o"],i=0;i<e.length&&!window.requestAnimationFrame;++i)window.requestAnimationFrame=window[e[i]+"RequestAnimationFrame"],window.cancelAnimationFrame=window[e[i]+"CancelAnimationFrame"]||window[e[i]+"CancelRequestAnimationFrame"];window.requestAnimationFrame||(window.requestAnimationFrame=function(e,i){var n=+new Date,o=Math.max(0,16-(n-t)),s=window.setTimeout(function(){e(n+o)},o);return t=n+o,s}),window.cancelAnimationFrame||(window.cancelAnimationFrame=function(t){clearTimeout(t)})}(),i.prototype._init=function(t){this.MAX_NUM=t.max||2,this.ROOT=document.querySelector(t.el),this.ROOT_WIDTH=document.documentElement.clientWidth,this.ROOT_HEIGHT=this.ROOT.offsetHeight,this.CLIENT_WIDTH=document.documentElement.clientWidth,this.CLIENT_HEIGHT=document.documentElement.clientHeight,this.CLIENT_DPR=window.devicePixelRatio||1,this.TEXT_ID=1,this.texts=[],this.queueText=[],this.textPool=[],this.TEXT_HEIGHT=20,this.sliceText=[],this.stage=this.createCanvas(this.ROOT_WIDTH*this.CLIENT_DPR,72*this.CLIENT_DPR),this.stageContext=this.stage.getContext("2d"),this.stage.style.width=this.ROOT_WIDTH+"px",this.stage.style.height="72px",this.stage.style.position="absolute",this.stage.style.backgroundImage="-webkit-linear-gradient(right, rgba(0,0, 0, 0) 0%, rgba(0,0, 0, 0.6) 100%)",this.stage.style.backgroundImage="linear-gradient(right, rgba(0,0, 0, 0) 0%, rgba(0,0, 0, 0.6) 100%)",this.stageContext.font=16*this.CLIENT_DPR+"px arial",this.stageContext.fillStyle="#fff",this.stageContext.textBaseline="top",this.stageContext.shadowColor="#000",this.stageContext.shadowOffsetX=0,this.stageContext.shadowOffsetY=1,this.stageContext.shadowBlur=1,this.ROOT.appendChild(this.stage),this.createPool(),this.animate(),this.defalutText=["点我可以弹字幕哦","闪电玩平台，指尖的精彩","闪电玩快来玩"]},i.prototype.createCanvas=function(t,e){var i=document.createElement("canvas");return i.width=t||this.CLIENT_WIDTH,i.height=e||this.CLIENT_HEIGHT,i},i.prototype.createPool=function(){for(var t=0;t<this.MAX_NUM;t++){var e=new n;e.textId=this.TEXT_ID++,e.y=18*(e.textId-1)*this.CLIENT_DPR,this.textPool.push(e)}},i.prototype.addText=function(t){var e,i;this.texts.length>=this.MAX_NUM?this.queueText.push(t):(e=this.textPool.shift(),e.text=t.msg,e.x=this.stage.width+this.selectFrom(0,10),i=Math.random(),e.speed=(this.selectFrom(2,3)+(i>.4?.4:i))*this.CLIENT_DPR/2,e.width=this.stageContext.measureText(t.msg).width,this.texts.push(e))},i.prototype.removeText=function(t){for(var e=0;e<this.texts.length;e++)if(this.texts[e].textId==t.textId)return this.texts.splice(e,1),this.textPool.push(t),void(t.text="")},i.prototype.selectFrom=function(t,e){var i=e-t+1;return Math.random()*i+t>>0},i.prototype.updateTexts=function(){for(var t=0;t<this.sliceText.length;t++);},i.prototype.animate=function(){this.timer=window.requestAnimationFrame(this.loop.bind(this))},i.prototype.loop=function(){this.stageContext.clearRect(0,0,this.stage.width,this.stage.height);for(var t=0,e=this.texts.length;t<e;){var i=this.texts[t];if(i&&i.text)if(i.x>>0<=-i.width){this.removeText(i);var n=this.queueText.length?this.queueText.shift():{msg:this.defalutText[this.selectFrom(0,this.defalutText.length-1)]};this.addText(n)}else i.x=i.x-i.speed,this.stageContext.fillText(i.text,i.x,i.y),t++}this.timer=window.requestAnimationFrame(this.loop.bind(this))},n.prototype._init=function(t){this.x=0,this.y=0,this.speed=0,this.text=t||"",this.width=0},n.prototype.updateCache=function(){this.stageContext.clearRect(0,0,this.canvas.width,this.canvas.height),this.stageContext.fillText(this.text,0,0),this.cacheText=this.stageContext.getImageData(0,0,1024,40)},t.exports=i},function(t,e){function i(t){return this.id=t.id||"",this.adsorbed=t.adsorbed||!0,this.duration=t.duration||.3,this.position=t.position||"1,0.5",this.adsorb=t.adsorb||!1,this.init(),this}i.prototype.init=function(){if(this.id){this.target=document.querySelector(this.id),this.WIDTH=document.documentElement.clientWidth||document.body.clientWidth,this.HEIGHT=document.documentElement.clientHeight||document.body.clientHeight,this.offX=0,this.offY=0,this.width=this.target.offsetWidth,this.height=this.target.offsetHeight,this.tapFlag=!1,this.timer=null,this.hasMove=!1;var t=this.position.split(","),e=parseFloat(t[0])*(this.WIDTH-this.width)>>0,i=parseFloat(t[1])*(this.HEIGHT-this.height)>>0;this.target.style.transform="translate3d("+e+"px,"+i+"px,0)",this.target.style.webkitTransform="translate3d("+e+"px,"+i+"px,0)",this.target.style.opacity="0.5",this.target.addEventListener("touchstart",this.touchDown.bind(this),!1),document.addEventListener("touchmove",this.touchMove.bind(this),!1),this.target.addEventListener("touchend",this.touchUp.bind(this),!1)}},i.prototype.touchDown=function(t){if(t.preventDefault(),!this.tapFlag){this.hasMove=!1,this.target.style.transition="none",this.target.style.webkitTransition="none",this.target.style.opacity="1";var e=this.target.getBoundingClientRect();if(t.touches)var i=t.touches[0];else var i=t;this.offX=i.clientX-e.left,this.offY=i.clientY-e.top,this.tapFlag=!0,clearTimeout(this.timer)}},i.prototype.touchMove=function(t){if(this.tapFlag){if(t.preventDefault(),this.hasMove=!0,t.changedTouches)var e=t.changedTouches[0];else var e=t;var i=e.clientY-this.offY,n=e.clientX-this.offX;i=Math.max(0,i),i=Math.min(this.HEIGHT-this.height,i),n=Math.max(0,n),n=Math.min(this.WIDTH-this.width,n),this.target.style.transform="translate3d("+n+"px,"+i+"px,0)",this.target.style.webkitTransform="translate3d("+n+"px,"+i+"px,0)"}},i.prototype.touchUp=function(t){if(t.preventDefault(),this.tapFlag){if(this.tapFlag=!1,t.changedTouches)var e=t.changedTouches[0];else var e=t;var i=e.clientX-this.offX,n=e.clientY-this.offY;if(n=Math.max(0,n),n=Math.min(this.HEIGHT-this.height,n),i=i<=this.WIDTH/2-this.width/2&&this.adsorb?0:this.WIDTH-this.width,this.top=n,this.left=i,this.target.style.webkitTransition="cubic-bezier(0.5,1.95,.49,.73)  "+this.duration+"s",this.target.style.transition="cubic-bezier(0.5,1.95,.49,.73)  "+this.duration+"s",this.target.style.webkitTransform="translate3d("+i+"px,"+n+"px,0)",this.target.style.transform="translate3d("+i+"px,"+n+"px,0)",this.timer=setTimeout(function(){this.target.style.opacity="0.5"}.bind(this),2e3),!this.hasMove){var o="canvas"==t.target.tagName.toLocaleLowerCase();("barrage-cont"==t.target.className||"barrage-text"==t.target.className||o)&&this.target.click()}}},t.exports=i},function(t,e){},function(t,e,i){i(2),i(1),window.toolWindow=i(0);HTTP_USER_STATIC+"authgame";SDW_WEB.onShandw?(SDW_WEB.getSdwUserData().then(function(t){checkVisitor(),authGame(),toolWindow.init(visitorMode.isVisitor)},function(t){}),SDW_WEB.sdw.onShowToolBarItems(["addDesktop"])):visitorMode.isVisitor?(visitorMode.authGame(),toolWindow.init(visitorMode.isVisitor)):(authGame(),toolWindow.init(visitorMode.isVisitor))}]);